<section class="popular">
  <div class="container head">
    <h2>Upcoming Events</h2>
    <a class="explore" href="#" aria-label="Explore events">Explore events â†—</a>
  </div>

  <div class="container grid">
    <article class="card reveal" #card *ngFor="let event of events">
      <div class="media">
        <img [src]="event.image" [alt]="event.title">
        <span class="badge" *ngIf="!event.isFull && event.seatsLeft > 0">AVAILABLE</span>
        <span class="badge full" *ngIf="event.isFull">FULL</span>
      </div>

      <div class="content">
        <h3 class="title">{{ event.title }}</h3>
        <p class="teacher">Date: {{ event.date | date:'medium' }}</p>

        <div class="row rating-price">
          <div class="rating">
            <span class="rating-val">{{ event.seatsLeft }}</span>
            <span>Seats Left</span>
          </div>
          <div class="price">Free</div>
        </div>

        <hr class="divider"/>

        <div class="row meta">
          <div class="meta-item">
            <svg class="mini" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M4 5h16v14H4z" fill="none" stroke="currentColor" stroke-width="1.5"/>
              <path d="M4 9h16" stroke="currentColor" stroke-width="1.5"/>
            </svg>
            <span>{{ event.users?.length || 0 }} Registrations</span>
          </div>
        </div>

        <!-- Move button to bottom center -->
        <button class="btn btn-show" [routerLink]="['/event', event.id]">Show</button>
      </div>
    </article>
  </div>
  <div *ngIf="selectedEvent" class="mt-5 p-4 bg-light rounded shadow-sm">
    <h3 class="mb-3">{{ selectedEvent.title }}</h3>
    <img *ngIf="selectedEvent.image" [src]="selectedEvent.image" alt="{{ selectedEvent.title }}" class="img-fluid mb-3" style="max-width: 300px;">
    <p class="mb-2">{{ selectedEvent.description }}</p>
    <p class="mb-2"><strong>Date:</strong> {{ selectedEvent.date | date:'medium' }}</p>
    <p class="mb-2"><strong>Seats Left:</strong> {{ selectedEvent.seatsLeft }}</p>
    <p class="mb-2"><strong>Status:</strong> {{ selectedEvent.isFull ? 'Event Full' : 'Available' }}</p>
    <p class="mb-0"><strong>Call to Join:</strong> <a href="tel:+1234567890">+1 (234) 567-890</a> (or WhatsApp)</p>
    <div *ngIf="selectedEvent.users?.length" class="mt-3">
      <h4>Registered Users</h4>
      <ul>
        <li *ngFor="let user of selectedEvent.users">{{ user.email }} ({{ user.role }})</li>
      </ul>
    </div>
  </div>
</section>
<app-ai-chat-bubble></app-ai-chat-bubble>
